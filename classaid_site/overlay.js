(function(){if(window.ClassAidOverlay)return;const K='classaid_notes';const R=()=>{try{return JSON.parse(localStorage.getItem(K))||{notes:[]}}catch{return{notes:[]}}};const W=v=>localStorage.setItem(K,JSON.stringify(v));const S=R();const root=document.createElement('div');Object.assign(root.style,{position:'fixed',inset:'0',pointerEvents:'none',zIndex:2147483647});document.body.appendChild(root);const bar=document.createElement('div');bar.style.cssText='position:fixed;right:16px;top:16px;background:#0d1311;border:1px solid #1b2622;color:#e8f1ed;padding:8px 10px;border-radius:12px;display:flex;gap:8px;align-items:center;pointer-events:auto';bar.innerHTML='<b>ClassAid Notes</b>';const add=document.createElement('button');add.textContent='New';add.style.cssText='pointer-events:auto;padding:6px 10px;border-radius:10px;border:1px solid #1b2622;background:#101614;color:#e8f1ed';const hide=document.createElement('button');hide.textContent='Hide';hide.style.cssText='pointer-events:auto;padding:6px 10px;border-radius:10px;border:1px solid #1b2622;background:#101614;color:#e8f1ed';bar.appendChild(add);bar.appendChild(hide);root.appendChild(bar);function note(n){const el=document.createElement('div');Object.assign(el.style,{position:'fixed',left:(n.x||60)+'px',top:(n.y||80)+'px',width:'220px',background:'#fff8c6',color:'#1a1a1a',border:'1px solid #d8c96a',borderRadius:'8px',boxShadow:'0 8px 20px rgba(0,0,0,.25)',padding:'8px',pointerEvents:'auto'});el.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px"><input class=tt style="border:none;background:transparent;font-weight:700;width:150px" value="${n.t||'Note'}"><button class=x style="border:none;background:transparent;font-weight:700">Ã—</button></div><textarea class=bd style="width:100%;height:120px;border:none;background:transparent">${n.b||''}</textarea>`;root.appendChild(el);let drag=false,dx=0,dy=0;el.querySelector('.tt').addEventListener('mousedown',e=>{drag=true;dx=e.clientX-parseInt(el.style.left);dy=e.clientY-parseInt(el.style.top);document.body.style.userSelect='none'});window.addEventListener('mousemove',e=>{if(!drag)return;el.style.left=(e.clientX-dx)+'px';el.style.top=(e.clientY-dy)+'px'});window.addEventListener('mouseup',()=>{if(drag){drag=false;document.body.style.userSelect='';save()}});el.querySelector('.x').onclick=()=>{S.notes=S.notes.filter(x=>x!==n);el.remove();save()};el.querySelector('.bd').oninput=save;el.querySelector('.tt').oninput=save}function save(){S.notes=Array.from(document.querySelectorAll('textarea.bd')).map((ta,i)=>{const el=ta.parentElement.parentElement;return{x:parseInt(el.style.left),y:parseInt(el.style.top),t:el.querySelector('.tt').value,b:ta.value}});W(S)}add.onclick=()=>{const n={x:80+Math.random()*60,y:120+Math.random()*60,t:'Note',b:''};S.notes.push(n);note(n);save()};hide.onclick=()=>{root.style.display='none'};S.notes.forEach(note);window.ClassAidOverlay={toggle(){root.style.display=(root.style.display==='none')?'block':'none'}}})()