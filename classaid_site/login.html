
<!doctype html><html lang='en'><head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<link rel='stylesheet' href='/styles.css'><title>Log in â€” ClassAid</title>
</head><body>
<nav class='nav'><div class='container row'>
  <div class='row' style='gap:10px'><img src='/favicon.svg' width='22' height='22'/><strong>ClassAid</strong></div>
  <div class='row' style='gap:10px'><a class='small' href='/'>Home</a><a class='btn' href='/app.html'>Open the App</a></div>
</div></nav>

<main class='container' style='max-width:640px'>
  <div class='card'>
    <h2>Welcome</h2>
    <p class='small'>Create a local account (no server) or sign in to your existing local profile.</p>
    <div class='input'><input id='email' placeholder='you@school.edu' type='email'></div>
    <div class='input'><input id='name' placeholder='Your name'></div>
    <div class='input'><input id='pass' placeholder='Passphrase (min 6)' type='password'></div>
    <div class='row'><button class='btn alt' id='signup'>Create account</button><button class='btn' id='signin'>Sign in</button></div>
    <p class='small'>Password is hashed and stored locally. You can export data anytime.</p>
  </div>
</main>

<script>
async function sha256(t){const d=new TextEncoder().encode(t);const h=await crypto.subtle.digest('SHA-256',d);return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('')}
function saveUser(u){localStorage.setItem('ca:user:'+u.email, JSON.stringify(u)); localStorage.setItem('ca:current', u.email); location.href='/app.html'}
async function doSignup(){const email=document.getElementById('email').value.trim();const name=document.getElementById('name').value.trim();const pass=document.getElementById('pass').value; if(!email||!name||pass.length<6){alert('Fill all fields (min 6 characters)');return;} const passhash=await sha256(pass); const u={email,name,passhash,created:Date.now(),settings:{fontScale:1,accent:'#00e090',contrast:false}}; saveUser(u)}
async function doSignin(){const email=document.getElementById('email').value.trim();const pass=document.getElementById('pass').value; const raw=localStorage.getItem('ca:user:'+email); if(!raw){alert('No account found. Create one.');return;} const u=JSON.parse(raw); const passhash=await sha256(pass); if(passhash!==u.passhash){alert('Wrong passphrase');return;} localStorage.setItem('ca:current', email); location.href='/app.html'}
document.getElementById('signup').onclick=doSignup; document.getElementById('signin').onclick=doSignin;
</script>
</body></html>
